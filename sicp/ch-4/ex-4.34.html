<!doctype html>
<html class="no-js" lang="en">
<head>
	<meta charset="utf-8" />

	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>SICP Solutions</title>
	<link rel="stylesheet" href="https://www.inchmeal.io/assets/css/styles_inchmeal.css"/>
	<link rel="alternate" type="application/rss+xml" title="Inchmeal RSS" href="/rss-feed.xml" />

	<script src="https://www.inchmeal.io/assets/js/inchmeal_head.js"></script>

	
	<script>
	window.MathJax = {
		chtml: {
			scale: 0.86,
			displayAlign: "left"
		},
		tex: {
			tags: "ams",
			macros: {
				Exp: "{\\operatorname{\\mathrm{E}}}",
				Var: "{\\operatorname{\\mathrm{Var}}}",
				Cov: "{\\operatorname{\\mathrm{Cov}}}",
				Abs: ['\\left\\lvert #2 \\right\\rvert_{\\text{#1}}', 2, ""],
				Prn: ['\\left( #2 \\right)_{\\text{#1}}', 2, ""]
			},
			inlineMath: [ ['$','$'], ['\\(', '\\)'] ],
			displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
			processEscapes: true,
			autoload: {
				color: [],
				colorV2: ['color']
			},
			packages: {'[+]': ['noerrors']}
		},
		options: {
			ignoreHtmlClass: 'tex2jax_ignore',
			processHtmlClass: 'tex2jax_process'
		},
		loader: {
			load: ['[tex]/noerrors']
		}
	};
	</script>
	
	<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>
	
	

	<meta name="google-site-verification" content="tCrxTm0EXch-6c8nlJPb_Cq-BOBcK9GR2ZP3I1lfLKs" />
	
	<meta name="description" content="Inchmeal | This page contains solutions for Structure and Interpretation of Computer Programs, SICP"/>

	

	



	
	<link rel="icon" sizes="32x32" href="https://www.inchmeal.io/assets/img/favicon-32x32.png">




	
	<link rel="icon" sizes="192x192" href="https://www.inchmeal.io/assets/img/touch-icon-192x192.png">




	
	<link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://www.inchmeal.io/assets/img/apple-touch-icon-180x180-precomposed.png">




	
	<link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://www.inchmeal.io/assets/img/apple-touch-icon-152x152-precomposed.png">




	
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.inchmeal.io/assets/img/apple-touch-icon-144x144-precomposed.png">




	
	<link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://www.inchmeal.io/assets/img/apple-touch-icon-120x120-precomposed.png">




	
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://www.inchmeal.io/assets/img/apple-touch-icon-114x114-precomposed.png">




	
	<link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://www.inchmeal.io/assets/img/apple-touch-icon-76x76-precomposed.png">




	
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://www.inchmeal.io/assets/img/apple-touch-icon-72x72-precomposed.png">




	
	<link rel="apple-touch-icon-precomposed" href="https://www.inchmeal.io/assets/img/apple-touch-icon-precomposed.png">	




	
	<meta name="msapplication-TileImage" content="https://www.inchmeal.io/assets/img/msapplication_tileimage.png"/>




	
	<meta name="msapplication-TileColor" content="#fabb00">



	<!-- Facebook Optimization -->
	<meta property="og:locale" content="en_EN" />
	
	<meta property="og:title" content="SICP Solutions" />
	<meta property="og:description" content="Inchmeal | This page contains solutions for Structure and Interpretation of Computer Programs, SICP"/>
	<meta property="og:url" content="https://www.inchmeal.io//sicp/ch-4/ex-4.34.html" />
	<meta property="og:site_name" content="inchmeal" />
	

	

	<!-- Search Engine Optimization -->
	

	<link type="text/plain" rel="author" href="https://www.inchmeal.io//humans.txt" />

	
</head>

<body id="top-of-page" class="">
	
<div id="navigation" class="sticky">
  <nav class="top-bar" data-topbar>
    <ul class="title-area">
      <li class="name">
        <h1>
          <a href="https://www.inchmeal.io">
            <img src="https://www.inchmeal.io/assets/img/logo.png"/>
          </a>
        </h1>
      </li>
       <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu"(text inside span) to just have icon alone -->
      <li class="toggle-topbar menu-icon"><a href="#"><span></span></a></li>
    </ul>
    <section class="top-bar-section">

      <ul class="right">
        

              

          
          
              <li class="divider"></li>
              <li><a href="https://www.inchmeal.io/">home</a></li>
          
        

              

          
          
              <li class="divider"></li>
              <li><a href="https://www.inchmeal.io/archives/">archives</a></li>
          
        

              

          
          
              <li class="divider"></li>
              <li><a href="https://www.inchmeal.io/about/">about</a></li>
          
        
        
      </ul>

      <ul class="left">
        <li class="divider"></li>
        

              

          
          
        

              

          
          
        

              

          
          
        
        
      </ul>
    </section>
  </nav>
</div><!-- /#navigation -->


	<!-- capture chapters -IMPORTANT- do not split below statement as it starts capturing new line which causes problems- -->





<!-- remove duplicates, convert to num and insert in array -->

    
    

    

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
            
            

    

    
    

    
        
    

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
    

    

    
    

    
        
    
        
    
        
    

    

    
    

    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    

    
    

    
        
    
        
    
        
    
        
            
            

    




<div class="row t30">
    <div class="medium-4 columns medium-push-8">
    </div>
    <div class="medium-8 columns medium-pull-4">
        <div class="row">
            <div class="medium-11 medium-offset-1 columns">
            <h1><a href="/sicp/index.html" >SICP Solutions</a></h1>
            </div>
        </div>
    </div>
</div>

<div class="row t10">
    <div class="medium-3 columns medium-push-9">
        <div class="row t5">
            <div class="medium-12 columns">

                <ul class="accordion" data-accordion>
                    

                    
                    

                    <li class="accordion-navigation">
                        <a href="#ch-1">Chapter 1</a>
                        
                        <div id="ch-1" class="content ">
                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/notes.html" ><span class="radius info label  icon-edit"></span></a>
                            

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.1.html" ><span class="radius info label ">1.1</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.2.html" ><span class="radius info label ">1.2</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.3.html" ><span class="radius info label ">1.3</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.4.html" ><span class="radius info label ">1.4</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.5.html" ><span class="radius info label ">1.5</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.6.html" ><span class="radius info label ">1.6</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.7.html" ><span class="radius info label ">1.7</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.8.html" ><span class="radius info label ">1.8</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.9.html" ><span class="radius info label ">1.9</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.10.html" ><span class="radius info label ">1.10</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.11.html" ><span class="radius info label ">1.11</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.12.html" ><span class="radius info label ">1.12</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.13.html" ><span class="radius info label ">1.13</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.14.html" ><span class="radius info label todo">1.14</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.15.html" ><span class="radius info label ">1.15</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.16.html" ><span class="radius info label ">1.16</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.17.html" ><span class="radius info label ">1.17</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.18.html" ><span class="radius info label ">1.18</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.19.html" ><span class="radius info label ">1.19</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.20.html" ><span class="radius info label ">1.20</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.21.html" ><span class="radius info label ">1.21</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.22.html" ><span class="radius info label ">1.22</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.23.html" ><span class="radius info label ">1.23</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.24.html" ><span class="radius info label ">1.24</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.25.html" ><span class="radius info label ">1.25</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.26.html" ><span class="radius info label ">1.26</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.27.html" ><span class="radius info label ">1.27</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.28.html" ><span class="radius info label ">1.28</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.29.html" ><span class="radius info label ">1.29</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.30.html" ><span class="radius info label ">1.30</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.31.html" ><span class="radius info label ">1.31</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.32.html" ><span class="radius info label ">1.32</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.33.html" ><span class="radius info label ">1.33</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.34.html" ><span class="radius info label ">1.34</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.35.html" ><span class="radius info label ">1.35</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.36.html" ><span class="radius info label ">1.36</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.37.html" ><span class="radius info label ">1.37</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.38.html" ><span class="radius info label ">1.38</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.39.html" ><span class="radius info label ">1.39</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.40.html" ><span class="radius info label ">1.40</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.41.html" ><span class="radius info label ">1.41</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.42.html" ><span class="radius info label ">1.42</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.43.html" ><span class="radius info label ">1.43</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.44.html" ><span class="radius info label ">1.44</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.45.html" ><span class="radius info label ">1.45</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-1/ex-1.46.html" ><span class="radius info label ">1.46</span></a>
							

                            
                        </div>
                    </li>
                    

                    
                    

                    <li class="accordion-navigation">
                        <a href="#ch-2">Chapter 2</a>
                        
                        <div id="ch-2" class="content ">
                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/notes.html" ><span class="radius info label  icon-edit"></span></a>
                            

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.1.html" ><span class="radius info label ">2.1</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.2.html" ><span class="radius info label ">2.2</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.3.html" ><span class="radius info label ">2.3</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.4.html" ><span class="radius info label ">2.4</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.5.html" ><span class="radius info label ">2.5</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.6.html" ><span class="radius info label ">2.6</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.7.html" ><span class="radius info label ">2.7</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.8.html" ><span class="radius info label ">2.8</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.9.html" ><span class="radius info label ">2.9</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.10.html" ><span class="radius info label ">2.10</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.11.html" ><span class="radius info label ">2.11</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.12.html" ><span class="radius info label ">2.12</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.13.html" ><span class="radius info label ">2.13</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.14.html" ><span class="radius info label ">2.14</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.15.html" ><span class="radius info label ">2.15</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.16.html" ><span class="radius info label todo">2.16</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.17.html" ><span class="radius info label ">2.17</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.18.html" ><span class="radius info label ">2.18</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.19.html" ><span class="radius info label ">2.19</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.20.html" ><span class="radius info label ">2.20</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.21.html" ><span class="radius info label ">2.21</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.22.html" ><span class="radius info label ">2.22</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.23.html" ><span class="radius info label ">2.23</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.24.html" ><span class="radius info label ">2.24</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.25.html" ><span class="radius info label ">2.25</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.26.html" ><span class="radius info label ">2.26</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.27.html" ><span class="radius info label ">2.27</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.28.html" ><span class="radius info label ">2.28</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.29.html" ><span class="radius info label ">2.29</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.30.html" ><span class="radius info label ">2.30</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.31.html" ><span class="radius info label ">2.31</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.32.html" ><span class="radius info label ">2.32</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.33.html" ><span class="radius info label ">2.33</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.34.html" ><span class="radius info label ">2.34</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.35.html" ><span class="radius info label ">2.35</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.36.html" ><span class="radius info label ">2.36</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.37.html" ><span class="radius info label ">2.37</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.38.html" ><span class="radius info label ">2.38</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.39.html" ><span class="radius info label ">2.39</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.40.html" ><span class="radius info label ">2.40</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.41.html" ><span class="radius info label ">2.41</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.42.html" ><span class="radius info label ">2.42</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.43.html" ><span class="radius info label ">2.43</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.44.html" ><span class="radius info label ">2.44</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.45.html" ><span class="radius info label ">2.45</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.46.html" ><span class="radius info label ">2.46</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.47.html" ><span class="radius info label ">2.47</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.48.html" ><span class="radius info label ">2.48</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.49.html" ><span class="radius info label ">2.49</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.50.html" ><span class="radius info label ">2.50</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.51.html" ><span class="radius info label ">2.51</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.52.html" ><span class="radius info label ">2.52</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.53.html" ><span class="radius info label ">2.53</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.54.html" ><span class="radius info label ">2.54</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.55.html" ><span class="radius info label ">2.55</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.56.html" ><span class="radius info label ">2.56</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.57.html" ><span class="radius info label ">2.57</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.58.html" ><span class="radius info label ">2.58</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.59.html" ><span class="radius info label ">2.59</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.60.html" ><span class="radius info label ">2.60</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.61.html" ><span class="radius info label ">2.61</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.62.html" ><span class="radius info label ">2.62</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.63.html" ><span class="radius info label ">2.63</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.64.html" ><span class="radius info label ">2.64</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.65.html" ><span class="radius info label ">2.65</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.66.html" ><span class="radius info label ">2.66</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.67.html" ><span class="radius info label ">2.67</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.68.html" ><span class="radius info label ">2.68</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.69.html" ><span class="radius info label ">2.69</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.70.html" ><span class="radius info label ">2.70</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.71.html" ><span class="radius info label ">2.71</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.72.html" ><span class="radius info label ">2.72</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.73.html" ><span class="radius info label ">2.73</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.74.html" ><span class="radius info label ">2.74</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.75.html" ><span class="radius info label ">2.75</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.76.html" ><span class="radius info label ">2.76</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.77.html" ><span class="radius info label ">2.77</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.78.html" ><span class="radius info label ">2.78</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.79.html" ><span class="radius info label ">2.79</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.80.html" ><span class="radius info label ">2.80</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.81.html" ><span class="radius info label ">2.81</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.82.html" ><span class="radius info label ">2.82</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.83.html" ><span class="radius info label ">2.83</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.84.html" ><span class="radius info label ">2.84</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.85.html" ><span class="radius info label ">2.85</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.86.html" ><span class="radius info label ">2.86</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.87.html" ><span class="radius info label ">2.87</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.88.html" ><span class="radius info label ">2.88</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.89.html" ><span class="radius info label ">2.89</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.90.html" ><span class="radius info label ">2.90</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.91.html" ><span class="radius info label ">2.91</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.92.html" ><span class="radius info label ">2.92</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.93.html" ><span class="radius info label ">2.93</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.94.html" ><span class="radius info label ">2.94</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.95.html" ><span class="radius info label ">2.95</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.96.html" ><span class="radius info label ">2.96</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-2/ex-2.97.html" ><span class="radius info label ">2.97</span></a>
							

                            
                        </div>
                    </li>
                    

                    
                    

                    <li class="accordion-navigation">
                        <a href="#ch-3">Chapter 3</a>
                        
                        <div id="ch-3" class="content ">
                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/notes.html" ><span class="radius info label  icon-edit"></span></a>
                            

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.1.html" ><span class="radius info label ">3.1</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.2.html" ><span class="radius info label ">3.2</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.3.html" ><span class="radius info label ">3.3</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.4.html" ><span class="radius info label ">3.4</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.5.html" ><span class="radius info label ">3.5</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.6.html" ><span class="radius info label ">3.6</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.7.html" ><span class="radius info label ">3.7</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.8.html" ><span class="radius info label ">3.8</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.9.html" ><span class="radius info label ">3.9</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.10.html" ><span class="radius info label ">3.10</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.11.html" ><span class="radius info label ">3.11</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.12.html" ><span class="radius info label ">3.12</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.13.html" ><span class="radius info label ">3.13</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.14.html" ><span class="radius info label ">3.14</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.15.html" ><span class="radius info label todo">3.15</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.16.html" ><span class="radius info label ">3.16</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.17.html" ><span class="radius info label ">3.17</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.18.html" ><span class="radius info label ">3.18</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.19.html" ><span class="radius info label ">3.19</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.20.html" ><span class="radius info label todo">3.20</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.21.html" ><span class="radius info label ">3.21</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.22.html" ><span class="radius info label ">3.22</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.23.html" ><span class="radius info label ">3.23</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.24.html" ><span class="radius info label ">3.24</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.25.html" ><span class="radius info label ">3.25</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.26.html" ><span class="radius info label ">3.26</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.27.html" ><span class="radius info label ">3.27</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.28.html" ><span class="radius info label ">3.28</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.29.html" ><span class="radius info label ">3.29</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.30.html" ><span class="radius info label ">3.30</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.31.html" ><span class="radius info label ">3.31</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.32.html" ><span class="radius info label ">3.32</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.33.html" ><span class="radius info label ">3.33</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.34.html" ><span class="radius info label ">3.34</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.35.html" ><span class="radius info label ">3.35</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.36.html" ><span class="radius info label todo">3.36</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.37.html" ><span class="radius info label ">3.37</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.38.html" ><span class="radius info label ">3.38</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.39.html" ><span class="radius info label ">3.39</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.40.html" ><span class="radius info label ">3.40</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.41.html" ><span class="radius info label ">3.41</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.42.html" ><span class="radius info label ">3.42</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.43.html" ><span class="radius info label ">3.43</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.44.html" ><span class="radius info label ">3.44</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.45.html" ><span class="radius info label ">3.45</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.46.html" ><span class="radius info label ">3.46</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.47.html" ><span class="radius info label ">3.47</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.48.html" ><span class="radius info label ">3.48</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.49.html" ><span class="radius info label ">3.49</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.50.html" ><span class="radius info label ">3.50</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.51.html" ><span class="radius info label ">3.51</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.52.html" ><span class="radius info label ">3.52</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.53.html" ><span class="radius info label ">3.53</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.54.html" ><span class="radius info label ">3.54</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.55.html" ><span class="radius info label ">3.55</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.56.html" ><span class="radius info label ">3.56</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.57.html" ><span class="radius info label ">3.57</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.58.html" ><span class="radius info label ">3.58</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.59.html" ><span class="radius info label ">3.59</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.60.html" ><span class="radius info label ">3.60</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.61.html" ><span class="radius info label ">3.61</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.62.html" ><span class="radius info label ">3.62</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.63.html" ><span class="radius info label ">3.63</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.64.html" ><span class="radius info label ">3.64</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.65.html" ><span class="radius info label ">3.65</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.66.html" ><span class="radius info label ">3.66</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.67.html" ><span class="radius info label ">3.67</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.68.html" ><span class="radius info label ">3.68</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.69.html" ><span class="radius info label ">3.69</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.70.html" ><span class="radius info label ">3.70</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.71.html" ><span class="radius info label ">3.71</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.72.html" ><span class="radius info label ">3.72</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.73.html" ><span class="radius info label ">3.73</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.74.html" ><span class="radius info label ">3.74</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.75.html" ><span class="radius info label ">3.75</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.76.html" ><span class="radius info label ">3.76</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.77.html" ><span class="radius info label ">3.77</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.78.html" ><span class="radius info label ">3.78</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.79.html" ><span class="radius info label ">3.79</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.80.html" ><span class="radius info label ">3.80</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.81.html" ><span class="radius info label ">3.81</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-3/ex-3.82.html" ><span class="radius info label ">3.82</span></a>
							

                            
                        </div>
                    </li>
                    

                    
                    

                    <li class="accordion-navigation">
                        <a href="#ch-4">Chapter 4</a>
                        
                        <div id="ch-4" class="content active">
                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/notes.html" ><span class="radius info label  icon-edit"></span></a>
                            

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.1.html" ><span class="radius info label ">4.1</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.2.html" ><span class="radius info label ">4.2</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.3.html" ><span class="radius info label ">4.3</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.4.html" ><span class="radius info label ">4.4</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.5.html" ><span class="radius info label ">4.5</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.6.html" ><span class="radius info label ">4.6</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.7.html" ><span class="radius info label ">4.7</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.8.html" ><span class="radius info label ">4.8</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.9.html" ><span class="radius info label ">4.9</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.10.html" ><span class="radius info label todo">4.10</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.11.html" ><span class="radius info label ">4.11</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.12.html" ><span class="radius info label ">4.12</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.13.html" ><span class="radius info label ">4.13</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.14.html" ><span class="radius info label ">4.14</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.15.html" ><span class="radius info label ">4.15</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.16.html" ><span class="radius info label ">4.16</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.17.html" ><span class="radius info label ">4.17</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.18.html" ><span class="radius info label ">4.18</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.19.html" ><span class="radius info label ">4.19</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.20.html" ><span class="radius info label ">4.20</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.21.html" ><span class="radius info label ">4.21</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.22.html" ><span class="radius info label ">4.22</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.23.html" ><span class="radius info label ">4.23</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.24.html" ><span class="radius info label ">4.24</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.25.html" ><span class="radius info label ">4.25</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.26.html" ><span class="radius info label ">4.26</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.27.html" ><span class="radius info label ">4.27</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.28.html" ><span class="radius info label ">4.28</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.29.html" ><span class="radius info label ">4.29</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.30.html" ><span class="radius info label ">4.30</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.31.html" ><span class="radius info label ">4.31</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.32.html" ><span class="radius info label ">4.32</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.33.html" ><span class="radius info label ">4.33</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.34.html" ><span class="radius success label ">4.34</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.35.html" ><span class="radius info label ">4.35</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.36.html" ><span class="radius info label ">4.36</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.37.html" ><span class="radius info label ">4.37</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.38.html" ><span class="radius info label ">4.38</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.39.html" ><span class="radius info label ">4.39</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.40.html" ><span class="radius info label ">4.40</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.41.html" ><span class="radius info label ">4.41</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.42.html" ><span class="radius info label ">4.42</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.43.html" ><span class="radius info label ">4.43</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.44.html" ><span class="radius info label ">4.44</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.45.html" ><span class="radius info label ">4.45</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.46.html" ><span class="radius info label ">4.46</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.47.html" ><span class="radius info label ">4.47</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.48.html" ><span class="radius info label ">4.48</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.49.html" ><span class="radius info label ">4.49</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.50.html" ><span class="radius info label ">4.50</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.51.html" ><span class="radius info label ">4.51</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.52.html" ><span class="radius info label ">4.52</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.53.html" ><span class="radius info label ">4.53</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.54.html" ><span class="radius info label ">4.54</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.55.html" ><span class="radius info label ">4.55</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.56.html" ><span class="radius info label ">4.56</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.57.html" ><span class="radius info label ">4.57</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.58.html" ><span class="radius info label ">4.58</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.59.html" ><span class="radius info label ">4.59</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.60.html" ><span class="radius info label ">4.60</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.61.html" ><span class="radius info label ">4.61</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.62.html" ><span class="radius info label ">4.62</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.63.html" ><span class="radius info label ">4.63</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.64.html" ><span class="radius info label ">4.64</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.65.html" ><span class="radius info label ">4.65</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.66.html" ><span class="radius info label ">4.66</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.67.html" ><span class="radius info label ">4.67</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.68.html" ><span class="radius info label ">4.68</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.69.html" ><span class="radius info label ">4.69</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.70.html" ><span class="radius info label ">4.70</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.71.html" ><span class="radius info label ">4.71</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.72.html" ><span class="radius info label ">4.72</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.73.html" ><span class="radius info label ">4.73</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.74.html" ><span class="radius info label ">4.74</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.75.html" ><span class="radius info label ">4.75</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.76.html" ><span class="radius info label ">4.76</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.77.html" ><span class="radius info label ">4.77</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.78.html" ><span class="radius info label ">4.78</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-4/ex-4.79.html" ><span class="radius info label todo">4.79</span></a>
							

                            
                        </div>
                    </li>
                    

                    
                    

                    <li class="accordion-navigation">
                        <a href="#ch-5">Chapter 5</a>
                        
                        <div id="ch-5" class="content ">
                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/notes.html" ><span class="radius info label  icon-edit"></span></a>
                            

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.1.html" ><span class="radius info label ">5.1</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.2.html" ><span class="radius info label ">5.2</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.3.html" ><span class="radius info label ">5.3</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.4.html" ><span class="radius info label ">5.4</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.5.html" ><span class="radius info label ">5.5</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.6.html" ><span class="radius info label ">5.6</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.7.html" ><span class="radius info label ">5.7</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.8.html" ><span class="radius info label ">5.8</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.9.html" ><span class="radius info label ">5.9</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.10.html" ><span class="radius info label ">5.10</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.11.html" ><span class="radius info label ">5.11</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.12.html" ><span class="radius info label ">5.12</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.13.html" ><span class="radius info label ">5.13</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.14.html" ><span class="radius info label ">5.14</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.15.html" ><span class="radius info label ">5.15</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.16.html" ><span class="radius info label ">5.16</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.17.html" ><span class="radius info label ">5.17</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.18.html" ><span class="radius info label ">5.18</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.19.html" ><span class="radius info label ">5.19</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.20.html" ><span class="radius info label ">5.20</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.21.html" ><span class="radius info label ">5.21</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.22.html" ><span class="radius info label ">5.22</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.23.html" ><span class="radius info label ">5.23</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.24.html" ><span class="radius info label ">5.24</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.25.html" ><span class="radius info label ">5.25</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.26.html" ><span class="radius info label ">5.26</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.27.html" ><span class="radius info label ">5.27</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.28.html" ><span class="radius info label ">5.28</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.29.html" ><span class="radius info label ">5.29</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.30.html" ><span class="radius info label todo">5.30</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.31.html" ><span class="radius info label ">5.31</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.32.html" ><span class="radius info label ">5.32</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.33.html" ><span class="radius info label ">5.33</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.34.html" ><span class="radius info label ">5.34</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.35.html" ><span class="radius info label ">5.35</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.36.html" ><span class="radius info label ">5.36</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.37.html" ><span class="radius info label ">5.37</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.38.html" ><span class="radius info label ">5.38</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.39.html" ><span class="radius info label ">5.39</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.40.html" ><span class="radius info label ">5.40</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.41.html" ><span class="radius info label ">5.41</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.42.html" ><span class="radius info label ">5.42</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.43.html" ><span class="radius info label ">5.43</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.44.html" ><span class="radius info label ">5.44</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.45.html" ><span class="radius info label ">5.45</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.46.html" ><span class="radius info label ">5.46</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.47.html" ><span class="radius info label ">5.47</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.48.html" ><span class="radius info label ">5.48</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.49.html" ><span class="radius info label ">5.49</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.50.html" ><span class="radius info label ">5.50</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.51.html" ><span class="radius info label todo">5.51</span></a>
							

                            
                            

                            

                            

                            
							    <a href="/sicp/ch-5/ex-5.52.html" ><span class="radius info label todo">5.52</span></a>
							

                            
                        </div>
                    </li>
                    
                </ul>

                <div class="show-for-small-down">
                    <hr class="t20"/>
                </div>

            </div>
        </div>
    </div><!-- /.medium-4.columns -->
    <div class="medium-9 columns medium-pull-3">
        <div class="row">
            <div class="medium-11 medium-offset-1 columns">
                <article itemscope itemtype="http://schema.org/Article">
                    <header>
                        <span itemprop="name">
                            
                            <h3>Chapter 4, Metalinguistic Abstraction</h3>
                            
                            
								
								
								<h4>Exercise 4.34</h4>
								
							
                        </span>
                    </header>

                    
                    <p class="tm10">
                        <time class="post-date pr20" datetime="March 19, 2018" itemprop="datePublished"> March 19, 2018</time>
                    </p>
                    

                    <span itemprop="articleSection">
                        <hr/>
                        <p>Note: I built it on top of the exercise where we implemeted parameter type based evaluation, <code class="highlighter-rouge">lazy</code>, <code class="highlighter-rouge">memo-lazy</code>(ex-4.31)</p>

<p>This simple looking requirement took my entire day! I hope it works and have not missed any cases :)</p>

<p>Added the output/test after the code below.</p>

<p>There are many nuances, it will take some time to write all the detail. The main pointers/ideas which I think can help in understanding the code:</p>

<ul>
  <li>As mentioned in exercise, We need to do some tagging to differentiate between the compound procedure and these <code class="highlighter-rouge">cons</code> procedures.</li>
  <li>Note that, it may occur that we can avoid tagging by comparing the text of expression with lambda we used to implement cons, but this is wrong because it is certainly possible to have another lambda whose text/body matches the cons lambda but they are two different procedures.</li>
  <li>Other possible way of avoiding tagging it to associate atleast one name with the procedure. So that we can get a procedure name like <code class="highlighter-rouge">procedure-name</code> similar to <code class="highlighter-rouge">procedure-body</code>. But this means we are changing a fundamental part of our language. So, tagging seems to be a better approach.</li>
  <li>We can do tagging by creating a pair of <code class="highlighter-rouge">pair</code> and our customised(or lazy we implemented) cons.</li>
  <li>But, ofcourse, we can not use our own <code class="highlighter-rouge">cons</code> for creating this pair. Why? :)</li>
  <li>The other way we can do tagging is to use, underlying <code class="highlighter-rouge">cons</code>.</li>
  <li>Mixing underlying <code class="highlighter-rouge">cons</code> and our <code class="highlighter-rouge">cons</code> comes with interesting results. For example, try calling <code class="highlighter-rouge">display</code> on this mixed structure :)</li>
  <li>How to display? Two possible ways:
    <ul>
      <li>To implement display function in the implemented language like we have implemented ‘cons’.</li>
      <li>To implement display function in the evaluator, thus we can use our host langauge.</li>
    </ul>
  </li>
  <li>Both approaches have their own pros and cons, in first approach we do not have any host language constructs available! So, we need to provide them as primitive procedures. In the second approach, we don’t have the lazy implementations of <code class="highlighter-rouge">cons</code> available to us.</li>
  <li>I tried the first approach, but it required availability of so many constructs like <code class="highlighter-rouge">eq?</code>, <code class="highlighter-rouge">pair?</code> and combined with the fact that the arguments our <code class="highlighter-rouge">cons</code> are lazy evaluated, it caused too many troubles.</li>
  <li>Second appraoch, turned out quite easier. Since I have all the evaluator code available, it turned out not a big deal to call implemented(lazy) language <code class="highlighter-rouge">cons</code>, <code class="highlighter-rouge">car</code> or <code class="highlighter-rouge">cdr</code>. We just call <code class="highlighter-rouge">actual-value</code> and pass it the syntax we want to evaluate.</li>
  <li>There’s only one hurdle now, Suppose the result of our evaluator(the lazy cons list) is <code class="highlighter-rouge">object</code>. Then, this call <code class="highlighter-rouge">(actual-value (list 'car object))</code> won’t work because our evaluator will try to evaluate <code class="highlighter-rouge">object</code> which we do not want. Because object is already the result of evaluation. So, a simple solution is to put this object under a variable say <code class="highlighter-rouge">'object</code> in the implemented langauge environment and then call <code class="highlighter-rouge">(actual-value (list 'car 'object))</code>. (Notice the quote before object).</li>
</ul>

<p>Oh, now the main part of the exercise:</p>

<ul>
  <li>Initially, I thought to first convert the language <code class="highlighter-rouge">cons</code> into host <code class="highlighter-rouge">cons</code> but.. since it requires traversing the list twice, I directly display it.</li>
  <li>I created a counter, that gets incremented every time a <strong>non-cons</strong> is printed.</li>
  <li>Well, ideally i guess it would be better to print in BFS order, but that would have required queue, So, I just traversed the lazy-lists with DFS traversal.</li>
  <li>I used the dreaded <em>assignment</em> for maintaining count as there seems to be no other quicker way.</li>
</ul>

<p>I hope, I covered the main points. Since this required many changes, I am putting up the complete code:</p>

<h4 id="complete-code">Complete Code</h4>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
</pre></td><td class="code"><pre><span class="c1">;;;;LAZY EVALUATOR FROM SECTION 4.2 OF</span>
<span class="c1">;;;; STRUCTURE AND INTERPRETATION OF COMPUTER PROGRAMS</span>

<span class="c1">;;;;Matches code in ch4.scm</span>
<span class="c1">;;;; Also includes enlarged primitive-procedures list</span>

<span class="c1">;;;;This file can be loaded into Scheme as a whole.</span>
<span class="c1">;;;;**NOTE**This file loads the metacircular evaluator of</span>
<span class="c1">;;;;  sections 4.1.1-4.1.4, since it uses the expression representation,</span>
<span class="c1">;;;;  environment representation, etc.</span>
<span class="c1">;;;;  You may need to change the (load ...) expression to work in your</span>
<span class="c1">;;;;  version of Scheme.</span>
<span class="c1">;;;;**WARNING: Don't load mceval twice (or you'll lose the primitives</span>
<span class="c1">;;;;  interface, due to renamings of apply).</span>

<span class="c1">;;;;Then you can initialize and start the evaluator by evaluating</span>
<span class="c1">;;;; the two lines at the end of the file ch4-mceval.scm</span>
<span class="c1">;;;; (setting up the global environment and starting the driver loop).</span>

<span class="c1">;;;; resetting the environment so that we can reload the file</span>
<span class="p">(</span><span class="nf">ge</span> <span class="p">(</span><span class="nf">make-top-level-environment</span><span class="p">))</span>
<span class="p">(</span><span class="nf">restart</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">;;;;  To run without memoization, reload the first version of force-it below</span>


<span class="c1">;;**implementation-dependent loading of evaluator file</span>
<span class="c1">;;Note: It is loaded first so that the section 4.2 definition</span>
<span class="c1">;; of eval overrides the definition from 4.1.1</span>
<span class="p">(</span><span class="nb">load</span> <span class="s">"ch4-mceval.scm"</span><span class="p">)</span>


<span class="c1">;;;SECTION 4.2.2</span>

<span class="c1">;;; Modifying the evaluator</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">eval</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nf">self-evaluating?</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">exp</span><span class="p">)</span>
        <span class="p">((</span><span class="nb">null?</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">exp</span><span class="p">)</span>
        <span class="p">((</span><span class="nf">variable?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nf">lookup-variable-value</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">))</span>
        <span class="p">((</span><span class="nf">quoted?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nf">quote-&gt;custom-cons</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">))</span>
        <span class="p">((</span><span class="nf">assignment?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nf">eval-assignment</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">))</span>
        <span class="p">((</span><span class="nf">definition?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nf">eval-definition</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">))</span>
        <span class="p">((</span><span class="nf">if?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nf">eval-if</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">))</span>
        <span class="p">((</span><span class="nf">lambda?</span> <span class="nv">exp</span><span class="p">)</span>
         <span class="p">(</span><span class="nf">make-procedure</span> <span class="p">(</span><span class="nf">lambda-parameters</span> <span class="nv">exp</span><span class="p">)</span>
                         <span class="p">(</span><span class="nf">lambda-body</span> <span class="nv">exp</span><span class="p">)</span>
                         <span class="nv">env</span><span class="p">))</span>
        <span class="p">((</span><span class="nf">begin?</span> <span class="nv">exp</span><span class="p">)</span> 
         <span class="p">(</span><span class="nf">eval-sequence</span> <span class="p">(</span><span class="nf">begin-actions</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">env</span><span class="p">))</span>
        <span class="p">((</span><span class="nf">cond?</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nb">eval</span> <span class="p">(</span><span class="nf">cond-&gt;if</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">env</span><span class="p">))</span>
        <span class="p">((</span><span class="nf">application?</span> <span class="nv">exp</span><span class="p">)</span>             <span class="c1">; clause from book</span>
         <span class="p">(</span><span class="nb">apply</span> <span class="p">(</span><span class="nf">actual-value</span> <span class="p">(</span><span class="nf">operator</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">env</span><span class="p">)</span>
                <span class="p">(</span><span class="nf">operands</span> <span class="nv">exp</span><span class="p">)</span>
                <span class="nv">env</span><span class="p">))</span>
        <span class="p">(</span><span class="k">else</span>
         <span class="p">(</span><span class="nf">error</span> <span class="s">"Unknown expression type -- EVAL"</span> <span class="nv">exp</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">actual-value</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">force-it</span> <span class="p">(</span><span class="nb">eval</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">apply</span> <span class="nv">procedure</span> <span class="nv">arguments</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nf">primitive-procedure?</span> <span class="nv">procedure</span><span class="p">)</span>
         <span class="p">(</span><span class="nf">apply-primitive-procedure</span>
          <span class="nv">procedure</span>
          <span class="p">(</span><span class="nf">list-of-arg-values</span> <span class="nv">arguments</span> <span class="nv">env</span><span class="p">)))</span> <span class="c1">; changed</span>
        <span class="p">((</span><span class="nf">compound-procedure?</span> <span class="nv">procedure</span><span class="p">)</span>
         <span class="p">(</span><span class="nf">eval-sequence</span>
          <span class="p">(</span><span class="nf">procedure-body</span> <span class="nv">procedure</span><span class="p">)</span>
          <span class="p">(</span><span class="nf">extend-environment</span>
           <span class="p">(</span><span class="nf">procedure-parameters</span> <span class="nv">procedure</span><span class="p">)</span>
           <span class="p">(</span><span class="nf">list-of-customized-args</span> <span class="p">(</span><span class="nf">procedure-params-types</span> <span class="nv">procedure</span><span class="p">)</span> <span class="nv">arguments</span> <span class="nv">env</span><span class="p">)</span> <span class="c1">; changed</span>
           <span class="p">(</span><span class="nf">procedure-environment</span> <span class="nv">procedure</span><span class="p">))))</span>
        <span class="p">(</span><span class="k">else</span>
         <span class="p">(</span><span class="nf">error</span>
          <span class="s">"Unknown procedure type -- APPLY"</span> <span class="nv">procedure</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">quote-it</span> <span class="nv">exp</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'quote</span> <span class="nv">exp</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">custom-cons?</span> <span class="nv">obj</span><span class="p">)</span> <span class="p">(</span><span class="nf">tagged-list?</span> <span class="nv">obj</span> <span class="ss">'pair</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-custom-cons-list</span> <span class="nv">exp</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="nv">exp</span><span class="p">)</span>
	  <span class="o">'</span><span class="p">()</span>
	  <span class="p">(</span><span class="nb">list</span> <span class="ss">'cons</span> <span class="p">(</span><span class="nf">quote-it</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">exp</span><span class="p">))</span> <span class="p">(</span><span class="nf">make-custom-cons-list</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">exp</span><span class="p">)))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">quote-&gt;custom-cons</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">l</span> <span class="p">(</span><span class="nf">text-of-quotation</span> <span class="nv">exp</span><span class="p">)))</span>
	<span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">l</span><span class="p">)</span>
		<span class="p">(</span><span class="nb">eval</span> <span class="p">(</span><span class="nf">make-custom-cons-list</span> <span class="nv">l</span><span class="p">)</span> <span class="nv">env</span><span class="p">)</span>
		<span class="nv">l</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">list-of-arg-values</span> <span class="nv">exps</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">no-operands?</span> <span class="nv">exps</span><span class="p">)</span>
      <span class="o">'</span><span class="p">()</span>
      <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">actual-value</span> <span class="p">(</span><span class="nf">first-operand</span> <span class="nv">exps</span><span class="p">)</span> <span class="nv">env</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">list-of-arg-values</span> <span class="p">(</span><span class="nf">rest-operands</span> <span class="nv">exps</span><span class="p">)</span>
                                <span class="nv">env</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">list-of-customized-args</span> <span class="nv">params-types</span> <span class="nv">exps</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">no-operands?</span> <span class="nv">exps</span><span class="p">)</span>
      <span class="o">'</span><span class="p">()</span>
      <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">customize-it</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">params-types</span><span class="p">)</span> <span class="p">(</span><span class="nf">first-operand</span> <span class="nv">exps</span><span class="p">)</span> <span class="nv">env</span><span class="p">)</span>
            <span class="p">(</span><span class="nf">list-of-customized-args</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">params-types</span><span class="p">)</span> <span class="p">(</span><span class="nf">rest-operands</span> <span class="nv">exps</span><span class="p">)</span>
									 <span class="nv">env</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-procedure</span> <span class="nv">parameters</span> <span class="nv">body</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="nv">split</span>
	<span class="p">(</span><span class="nf">fold-right</span> <span class="p">(</span><span class="k">lambda</span><span class="p">(</span><span class="nf">new</span> <span class="nv">rem</span><span class="p">)</span>
				  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">param</span>
						 <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">pair?</span> <span class="nv">new</span><span class="p">)</span>
							 <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="k">or</span> <span class="p">(</span><span class="nf">lazy-param?</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">new</span><span class="p">))</span>
									 <span class="p">(</span><span class="nf">memo-lazy-param?</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">new</span><span class="p">)))</span>
								 <span class="nv">new</span>
								 <span class="p">(</span><span class="nf">error</span> <span class="s">"Wrong parameter type: "</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">new</span><span class="p">)))</span>
							 <span class="p">(</span><span class="nb">list</span> <span class="nv">new</span> <span class="o">'</span><span class="p">()))))</span>
					<span class="p">(</span><span class="nb">cons</span>
					 <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">param</span><span class="p">)</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">rem</span><span class="p">))</span> 
					 <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">param</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">rem</span><span class="p">)))))</span>
				<span class="p">(</span><span class="nb">cons</span> <span class="o">'</span><span class="p">()</span> <span class="o">'</span><span class="p">())</span>
				<span class="nv">parameters</span><span class="p">))</span> 
  <span class="p">(</span><span class="nb">list</span> <span class="ss">'procedure</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">split</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">split</span><span class="p">)</span> <span class="nv">body</span> <span class="nv">env</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">compound-procedure?</span> <span class="nv">p</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">tagged-list?</span> <span class="nv">p</span> <span class="ss">'procedure</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">procedure-parameters</span> <span class="nv">p</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">p</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">procedure-params-types</span> <span class="nv">p</span><span class="p">)</span> <span class="p">(</span><span class="nb">caddr</span> <span class="nv">p</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">procedure-body</span> <span class="nv">p</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadddr</span> <span class="nv">p</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">procedure-environment</span> <span class="nv">p</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadddr</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">p</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">eval-if</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">true?</span> <span class="p">(</span><span class="nf">actual-value</span> <span class="p">(</span><span class="nf">if-predicate</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">env</span><span class="p">))</span>
      <span class="p">(</span><span class="nb">eval</span> <span class="p">(</span><span class="nf">if-consequent</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">env</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">eval</span> <span class="p">(</span><span class="nf">if-alternative</span> <span class="nv">exp</span><span class="p">)</span> <span class="nv">env</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">input-prompt</span> <span class="s">";;; L-Eval input:"</span><span class="p">)</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">output-prompt</span> <span class="s">";;; L-Eval value:"</span><span class="p">)</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">driver-loop</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">prompt-for-input</span> <span class="nv">input-prompt</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">input</span> <span class="p">(</span><span class="nb">read</span><span class="p">)))</span>
	<span class="p">(</span><span class="k">define</span> <span class="nv">stime</span> <span class="p">(</span><span class="nf">get-universal-time</span><span class="p">))</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">output</span>
           <span class="p">(</span><span class="nf">actual-value</span> <span class="nv">input</span> <span class="nv">the-global-environment</span><span class="p">)))</span>
	  <span class="c1">;; (newline)</span>
	  <span class="c1">;; (display (list "Time Taken: " (- (get-universal-time) stime)))</span>
	  <span class="c1">;; (newline)</span>
      <span class="p">(</span><span class="nf">announce-output</span> <span class="nv">output-prompt</span><span class="p">)</span>
      <span class="p">(</span><span class="nf">user-print</span> <span class="nv">output</span><span class="p">)))</span>
  <span class="p">(</span><span class="nf">driver-loop</span><span class="p">))</span>


<span class="c1">;;; Representing thunks</span>

<span class="c1">;; non-memoizing version of force-it</span>

<span class="c1">;; (define (force-it obj)</span>
<span class="c1">;;   (if (thunk? obj)</span>
<span class="c1">;;       (actual-value (thunk-exp obj) (thunk-env obj))</span>
<span class="c1">;;       obj))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">lazy-param?</span> <span class="nv">param-type</span><span class="p">)</span> <span class="p">(</span><span class="nb">eq?</span> <span class="ss">'lazy</span> <span class="nv">param-type</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">memo-lazy-param?</span> <span class="nv">param-type</span><span class="p">)</span> <span class="p">(</span><span class="nb">eq?</span> <span class="ss">'memo-lazy</span> <span class="nv">param-type</span><span class="p">))</span>

<span class="c1">;; thunks</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">customize-it</span> <span class="nv">param-type</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nf">lazy-param?</span> <span class="nv">param-type</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'lazy-thunk</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">))</span>
		<span class="p">((</span><span class="nf">memo-lazy-param?</span> <span class="nv">param-type</span><span class="p">)</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'memo-thunk</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">))</span>
		<span class="p">(</span><span class="k">else</span> <span class="p">(</span><span class="nf">actual-value</span> <span class="nv">exp</span> <span class="nv">env</span><span class="p">))))</span>

<span class="c1">;(define (delay-it exp env)</span>
<span class="c1">;  (list 'thunk exp env))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">thunk?</span> <span class="nv">obj</span><span class="p">)</span>
  <span class="p">(</span><span class="k">or</span> <span class="p">(</span><span class="nf">lazy-thunk?</span> <span class="nv">obj</span><span class="p">)</span> <span class="p">(</span><span class="nf">memo-thunk?</span> <span class="nv">obj</span><span class="p">)))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">lazy-thunk?</span> <span class="nv">obj</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">tagged-list?</span> <span class="nv">obj</span> <span class="ss">'lazy-thunk</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">memo-thunk?</span> <span class="nv">obj</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">tagged-list?</span> <span class="nv">obj</span> <span class="ss">'memo-thunk</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">thunk-exp</span> <span class="nv">thunk</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">thunk</span><span class="p">))</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">thunk-env</span> <span class="nv">thunk</span><span class="p">)</span> <span class="p">(</span><span class="nb">caddr</span> <span class="nv">thunk</span><span class="p">))</span>

<span class="c1">;; "thunk" that has been forced and is storing its (memoized) value</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">evaluated-thunk?</span> <span class="nv">obj</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">tagged-list?</span> <span class="nv">obj</span> <span class="ss">'evaluated-thunk</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">thunk-value</span> <span class="nv">evaluated-thunk</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr</span> <span class="nv">evaluated-thunk</span><span class="p">))</span>

<span class="c1">;; memoizing version of force-it</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">force-it</span> <span class="nv">obj</span><span class="p">)</span>
  <span class="p">(</span><span class="k">cond</span> <span class="p">((</span><span class="nf">memo-thunk?</span> <span class="nv">obj</span><span class="p">)</span>
         <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">result</span> <span class="p">(</span><span class="nf">actual-value</span>
                        <span class="p">(</span><span class="nf">thunk-exp</span> <span class="nv">obj</span><span class="p">)</span>
                        <span class="p">(</span><span class="nf">thunk-env</span> <span class="nv">obj</span><span class="p">))))</span>
           <span class="p">(</span><span class="nb">set-car!</span> <span class="nv">obj</span> <span class="ss">'evaluated-thunk</span><span class="p">)</span>
           <span class="p">(</span><span class="nb">set-car!</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">obj</span><span class="p">)</span> <span class="nv">result</span><span class="p">)</span>  <span class="c1">; replace exp with its value</span>
           <span class="p">(</span><span class="nb">set-cdr!</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">obj</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>     <span class="c1">; forget unneeded env</span>
           <span class="nv">result</span><span class="p">))</span>
		<span class="p">((</span><span class="nf">lazy-thunk?</span> <span class="nv">obj</span><span class="p">)</span> <span class="p">(</span><span class="nf">actual-value</span> <span class="p">(</span><span class="nf">thunk-exp</span> <span class="nv">obj</span><span class="p">)</span> <span class="p">(</span><span class="nf">thunk-env</span> <span class="nv">obj</span><span class="p">)))</span>
        <span class="p">((</span><span class="nf">evaluated-thunk?</span> <span class="nv">obj</span><span class="p">)</span>
         <span class="p">(</span><span class="nf">thunk-value</span> <span class="nv">obj</span><span class="p">))</span>
        <span class="p">(</span><span class="k">else</span> <span class="nv">obj</span><span class="p">)))</span>

<span class="c1">;; A longer list of primitives -- suitable for running everything in 4.2</span>
<span class="c1">;; Overrides the list in ch4-mceval.scm</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">primitive-procedures</span>
  <span class="p">(</span><span class="nb">list</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'underlying-car</span> <span class="nv">car</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">list</span> <span class="ss">'underlying-cdr</span> <span class="nv">cdr</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">list</span> <span class="ss">'underlying-cons</span> <span class="nv">cons</span><span class="p">)</span>
        <span class="c1">;(list 'list list)</span>
        <span class="p">(</span><span class="nb">list</span> <span class="ss">'+</span> <span class="nv">+</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">list</span> <span class="ss">'-</span> <span class="nv">-</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">list</span> <span class="ss">'*</span> <span class="nv">*</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">list</span> <span class="ss">'/</span> <span class="nv">/</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">list</span> <span class="ss">'=</span> <span class="nv">=</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">list</span> <span class="ss">'newline</span> <span class="nv">newline</span><span class="p">)</span>
        <span class="p">(</span><span class="nb">list</span> <span class="ss">'display</span> <span class="nv">display</span><span class="p">)</span>
<span class="c1">;;      more primitives</span>
        <span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">custom-&gt;cons</span> <span class="nv">object</span><span class="p">)</span>
  <span class="p">(</span><span class="k">define</span> <span class="nv">temp-env</span>
	<span class="p">(</span><span class="nf">extend-environment</span>
	 <span class="p">(</span><span class="nb">list</span> <span class="ss">'object</span><span class="p">)</span>
	 <span class="p">(</span><span class="nb">list</span> <span class="nv">object</span><span class="p">)</span>
	 <span class="nv">the-global-environment</span><span class="p">))</span>

  <span class="p">(</span><span class="nb">cons</span>
   <span class="p">(</span><span class="nf">actual-value</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'car</span> <span class="ss">'object</span><span class="p">)</span> <span class="nv">temp-env</span><span class="p">)</span>
   <span class="p">(</span><span class="nf">actual-value</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'cdr</span> <span class="ss">'object</span><span class="p">)</span> <span class="nv">temp-env</span><span class="p">)))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">MAX-ITEMS</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">make-counter</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons</span> <span class="ss">'counter</span> <span class="mi">0</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">print-list</span> <span class="nv">items</span> <span class="nv">counter</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">custom-cons?</span> <span class="nv">items</span><span class="p">)</span>
	  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">&gt;</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">counter</span><span class="p">)</span> <span class="nv">MAX-ITEMS</span><span class="p">)</span>
		  <span class="p">(</span><span class="nb">display</span> <span class="s">"..."</span><span class="p">)</span>
		  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">ucons</span> <span class="p">(</span><span class="nf">custom-&gt;cons</span> <span class="nv">items</span><span class="p">)))</span>
			<span class="p">(</span><span class="nf">print-custom-cons</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">ucons</span><span class="p">)</span> <span class="nv">counter</span><span class="p">)</span>
			<span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nb">null?</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">ucons</span><span class="p">))</span>
				<span class="p">(</span><span class="nb">display</span> <span class="s">""</span><span class="p">)</span>
				<span class="p">(</span><span class="k">begin</span> <span class="p">(</span><span class="nb">display</span> <span class="s">" "</span><span class="p">)</span>
					   <span class="p">(</span><span class="nf">print-list</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">ucons</span><span class="p">)</span> <span class="nv">counter</span><span class="p">)))))</span>
	  <span class="p">(</span><span class="k">begin</span> <span class="p">(</span><span class="nb">set-cdr!</span> <span class="nv">counter</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">counter</span><span class="p">)</span> <span class="mi">1</span><span class="p">))</span>
			 <span class="p">(</span><span class="nb">display</span> <span class="s">"."</span><span class="p">)</span>
			 <span class="p">(</span><span class="nb">display</span> <span class="s">" "</span><span class="p">)</span>
			 <span class="p">(</span><span class="nb">display</span> <span class="nv">items</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">print-custom-cons</span> <span class="nv">object</span> <span class="nv">counter</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">custom-cons?</span> <span class="nv">object</span><span class="p">)</span>
	  <span class="p">(</span><span class="k">begin</span>
		<span class="p">(</span><span class="nb">display</span> <span class="s">"("</span><span class="p">)</span>
		<span class="p">(</span><span class="nf">print-list</span> <span class="nv">object</span> <span class="nv">counter</span><span class="p">)</span>
		<span class="p">(</span><span class="nb">display</span> <span class="s">")"</span><span class="p">))</span>
	  <span class="p">(</span><span class="k">begin</span> <span class="p">(</span><span class="nb">set-cdr!</span> <span class="nv">counter</span> <span class="p">(</span><span class="nb">+</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">counter</span><span class="p">)</span> <span class="mi">1</span><span class="p">))</span>
			 <span class="p">(</span><span class="nb">display</span> <span class="nv">object</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">user-print</span> <span class="nv">object</span><span class="p">)</span>
  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">compound-procedure?</span> <span class="nv">object</span><span class="p">)</span>
      <span class="p">(</span><span class="nb">display</span> <span class="p">(</span><span class="nb">list</span> <span class="ss">'compound-procedure</span>
                     <span class="p">(</span><span class="nf">procedure-parameters</span> <span class="nv">object</span><span class="p">)</span>
                     <span class="p">(</span><span class="nf">procedure-body</span> <span class="nv">object</span><span class="p">)</span>
                     <span class="ss">'&lt;procedure-env&gt;</span><span class="p">))</span>
	  <span class="p">(</span><span class="k">if</span> <span class="p">(</span><span class="nf">custom-cons?</span> <span class="nv">object</span><span class="p">)</span>
		  <span class="p">(</span><span class="nf">print-custom-cons</span> <span class="nv">object</span> <span class="p">(</span><span class="nf">make-counter</span><span class="p">))</span>
		  <span class="p">(</span><span class="nb">display</span> <span class="nv">object</span><span class="p">))))</span>

<span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nf">setup-environment</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nf">initial-env</span>
         <span class="p">(</span><span class="nf">extend-environment</span> <span class="p">(</span><span class="nf">primitive-procedure-names</span><span class="p">)</span>
                             <span class="p">(</span><span class="nf">primitive-procedure-objects</span><span class="p">)</span>
                             <span class="nv">the-empty-environment</span><span class="p">)))</span>
    <span class="p">(</span><span class="nf">define-variable!</span> <span class="ss">'true</span> <span class="nv">true</span> <span class="nv">initial-env</span><span class="p">)</span>
    <span class="p">(</span><span class="nf">define-variable!</span> <span class="ss">'false</span> <span class="nv">false</span> <span class="nv">initial-env</span><span class="p">)</span>

	<span class="p">(</span><span class="nf">actual-value</span> <span class="o">'</span><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nf">x</span> <span class="nv">memo-lazy</span><span class="p">)</span> <span class="p">(</span><span class="nf">y</span> <span class="nv">memo-lazy</span><span class="p">))</span>
							  <span class="p">(</span><span class="nf">underlying-cons</span> <span class="ss">'pair</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">(</span><span class="nf">m</span><span class="p">)</span> <span class="p">(</span><span class="nf">m</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">))))</span> <span class="nv">initial-env</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">actual-value</span> <span class="o">'</span><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">z</span><span class="p">)</span>
					 <span class="p">((</span><span class="nf">underlying-cdr</span> <span class="nv">z</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">((</span><span class="nf">p</span> <span class="nv">memo-lazy</span><span class="p">)</span> <span class="p">(</span><span class="nf">q</span> <span class="nv">memo-lazy</span><span class="p">))</span> <span class="nv">p</span><span class="p">)))</span>
				  <span class="nv">initial-env</span><span class="p">)</span>
	<span class="p">(</span><span class="nf">actual-value</span> <span class="o">'</span><span class="p">(</span><span class="k">define</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">z</span><span class="p">)</span>
					 <span class="p">((</span><span class="nf">underlying-cdr</span> <span class="nv">z</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda</span> <span class="p">((</span><span class="nf">p</span> <span class="nv">memo-lazy</span><span class="p">)</span> <span class="p">(</span><span class="nf">q</span> <span class="nv">memo-lazy</span><span class="p">))</span> <span class="nv">q</span><span class="p">)))</span>
				  <span class="nv">initial-env</span><span class="p">)</span>
    <span class="nv">initial-env</span><span class="p">))</span>

<span class="p">(</span><span class="k">define</span> <span class="nv">the-global-environment</span> <span class="p">(</span><span class="nf">setup-environment</span><span class="p">))</span>
<span class="p">(</span><span class="nf">driver-loop</span><span class="p">)</span>

<span class="ss">'LAZY-EVALUATOR-LOADED</span>
</pre></td></tr></tbody></table></code></pre></figure>

<hr />

<h4 id="test-examples">Test Examples</h4>

<p>First these are the outputs from my implementation as part of this exercise. Next, I also presented the output when same input is passed to the mit-scheme.</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
</pre></td><td class="code"><pre><span class="c1">;;; L-Eval input:</span>
<span class="o">'</span><span class="p">(</span><span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nf">d</span> <span class="nv">e</span> <span class="o">'</span><span class="p">(</span><span class="nf">f</span> <span class="nv">g</span><span class="p">)</span> <span class="nv">h</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="o">'</span><span class="p">(</span><span class="nf">i</span> <span class="nv">j</span><span class="p">)</span> <span class="nv">k</span><span class="p">)</span> <span class="nv">l</span> <span class="nv">m</span> <span class="nv">n</span> <span class="o">'</span><span class="p">(</span><span class="nf">o</span> <span class="nv">p</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nf">q</span> <span class="nv">r</span> <span class="nv">s</span><span class="p">)</span> <span class="nv">t</span> <span class="nv">u</span> <span class="nv">v</span> <span class="nv">w</span> <span class="nv">x</span> <span class="o">'</span><span class="p">(</span><span class="nf">y</span> <span class="nv">z</span><span class="p">))</span>
<span class="c1">;;; L-Eval value:</span>
<span class="p">((</span><span class="k">quote</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">))</span> <span class="p">(</span><span class="k">quote</span> <span class="p">(</span><span class="nf">d</span> <span class="nv">e</span> <span class="p">(</span><span class="k">quote</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">g</span><span class="p">))</span> <span class="nv">h</span><span class="p">))</span> <span class="o">...</span><span class="p">)</span>
<span class="c1">;;; L-Eval input:</span>
<span class="o">'</span><span class="p">()</span>
<span class="c1">;;; L-Eval value:</span>
<span class="p">()</span>
<span class="c1">;;; L-Eval input:</span>
<span class="ss">'1</span>
<span class="c1">;;; L-Eval value:</span>
<span class="mi">1</span>
<span class="c1">;;; L-Eval input:</span>
<span class="ss">'a</span>
<span class="c1">;;; L-Eval value:</span>
<span class="nv">a</span>
<span class="c1">;;; L-Eval input:</span>
<span class="o">'</span><span class="ss">'a</span>
<span class="c1">;;; L-Eval value:</span>
<span class="p">(</span><span class="k">quote</span> <span class="nv">a</span><span class="p">)</span>
<span class="c1">;;; L-Eval input:</span>
<span class="p">(</span><span class="nb">car</span> <span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">))</span>
<span class="c1">;;; L-Eval value:</span>
<span class="nv">a</span>
<span class="c1">;;; L-Eval input:</span>
<span class="p">(</span><span class="nb">car</span> <span class="o">'</span><span class="p">(</span><span class="ss">'a</span> <span class="ss">'b</span><span class="p">))</span>
<span class="c1">;;; L-Eval value:</span>
<span class="p">(</span><span class="k">quote</span> <span class="nv">a</span><span class="p">)</span>
<span class="c1">;;; L-Eval input:</span>
<span class="p">(</span><span class="nb">cdr</span> <span class="o">'</span><span class="p">(</span><span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">)))</span>
<span class="c1">;;; L-Eval value:</span>
<span class="p">((</span><span class="k">quote</span> <span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">)))</span>
<span class="c1">;;; L-Eval input:</span>
<span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="o">'</span><span class="p">(</span><span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">))))</span>
<span class="c1">;;; L-Eval value:</span>
<span class="p">(</span><span class="k">quote</span> <span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">))</span>
<span class="c1">;;; L-Eval input:</span>
<span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="o">'</span><span class="p">(</span><span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">))))))</span>
<span class="c1">;;; L-Eval value:</span>
<span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">)</span>
<span class="c1">;;; L-Eval input:</span>
<span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="o">'</span><span class="p">(</span><span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">)))))))</span>
<span class="c1">;;; L-Eval value:</span>
<span class="nv">c</span>
<span class="c1">;;; L-Eval input:</span>
<span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="o">'</span><span class="p">(</span><span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">)))))))</span>
<span class="c1">;;; L-Eval value:</span>
<span class="p">(</span><span class="nf">d</span><span class="p">)</span>
<span class="c1">;;; L-Eval input:</span>
<span class="p">(</span><span class="nb">cons</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1">;;; L-Eval value:</span>
<span class="p">(</span><span class="nf">1</span> <span class="o">.</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1">;;; L-Eval input:</span>
<span class="p">(</span><span class="k">define</span> <span class="nv">ones</span> <span class="p">(</span><span class="nb">cons</span> <span class="mi">1</span> <span class="nv">ones</span><span class="p">))</span>
<span class="c1">;;; L-Eval value:</span>
<span class="nv">ok</span>
<span class="c1">;;; L-Eval input:</span>
<span class="nv">ones</span>
<span class="c1">;;; L-Eval value:</span>
<span class="p">(</span><span class="nf">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="o">...</span><span class="p">)</span>
<span class="c1">;;; L-Eval input:</span>
<span class="p">(</span><span class="nb">cons</span> <span class="ss">'a</span> <span class="p">(</span><span class="nb">cons</span> <span class="ss">'b</span> <span class="p">(</span><span class="nb">cons</span> <span class="ss">'c</span> <span class="o">'</span><span class="p">())))</span>
<span class="c1">;;; L-Eval value:</span>
<span class="p">(</span><span class="nf">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></figure>

<p>Output from MIT scheme:</p>

<figure class="highlight"><pre><code class="language-scheme" data-lang="scheme"><table class="rouge-table"><tbody><tr><td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="code"><pre><span class="mi">1</span> <span class="p">]</span><span class="nv">=&gt;</span> <span class="o">'</span><span class="p">(</span><span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nf">d</span> <span class="nv">e</span> <span class="o">'</span><span class="p">(</span><span class="nf">f</span> <span class="nv">g</span><span class="p">)</span> <span class="nv">h</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="o">'</span><span class="p">(</span><span class="nf">i</span> <span class="nv">j</span><span class="p">)</span> <span class="nv">k</span><span class="p">)</span> <span class="nv">l</span> <span class="nv">m</span> <span class="nv">n</span> <span class="o">'</span><span class="p">(</span><span class="nf">o</span> <span class="nv">p</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nf">q</span> <span class="nv">r</span> <span class="nv">s</span><span class="p">)</span> <span class="nv">t</span> <span class="nv">u</span> <span class="nv">v</span> <span class="nv">w</span> <span class="nv">x</span> <span class="o">'</span><span class="p">(</span><span class="nf">y</span> <span class="nv">z</span><span class="p">))</span>
<span class="p">)</span>
<span class="c1">;Value 3: ((quote (a b c)) (quote (d e (quote (f g)) h)) (quote ((quote (i j)) k)) l m n (quote (o p)) (quote (q r s)) t u v w x (quote (y z)))</span>
<span class="mi">1</span> <span class="p">]</span><span class="nv">=&gt;</span> <span class="o">'</span><span class="p">()</span>
<span class="mi">1</span> <span class="p">]</span><span class="nv">=&gt;</span> 
<span class="c1">;Value: ()</span>
<span class="mi">1</span> <span class="p">]</span><span class="nv">=&gt;</span> <span class="ss">'1</span>
<span class="c1">;Value: 1</span>
<span class="mi">1</span> <span class="p">]</span><span class="nv">=&gt;</span> <span class="ss">'a</span>
<span class="c1">;Value: a</span>
<span class="mi">1</span> <span class="p">]</span><span class="nv">=&gt;</span> <span class="o">'</span><span class="ss">'a</span>
<span class="c1">;Value 4: (quote a)</span>
<span class="mi">1</span> <span class="p">]</span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">car</span> <span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">))</span>
<span class="c1">;Value: a</span>
<span class="mi">1</span> <span class="p">]</span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">car</span> <span class="o">'</span><span class="p">(</span><span class="ss">'a</span> <span class="ss">'b</span><span class="p">))</span>
<span class="c1">;Value 5: (quote a)</span>
<span class="mi">1</span> <span class="p">]</span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">cdr</span> <span class="o">'</span><span class="p">(</span><span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">)))</span>
<span class="c1">;Value 6: ((quote (c d)))</span>
<span class="mi">1</span> <span class="p">]</span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="o">'</span><span class="p">(</span><span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">))))</span>
<span class="c1">;Value 7: (quote (c d))</span>
<span class="mi">1</span> <span class="p">]</span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="o">'</span><span class="p">(</span><span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">))))))</span>
<span class="c1">;Value 8: (c d)</span>
<span class="mi">1</span> <span class="p">]</span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="o">'</span><span class="p">(</span><span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">)))))))</span>
<span class="c1">;Value: c</span>
<span class="mi">1</span> <span class="p">]</span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="p">(</span><span class="nb">car</span> <span class="p">(</span><span class="nb">cdr</span> <span class="o">'</span><span class="p">(</span><span class="o">'</span><span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="o">'</span><span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">)))))))</span>
<span class="c1">;Value 9: (d)</span>
<span class="mi">1</span> <span class="p">]</span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">cons</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1">;Value 19: (1 . 2)</span>
<span class="mi">1</span> <span class="p">]</span><span class="nv">=&gt;</span> <span class="p">(</span><span class="nb">cons</span> <span class="ss">'a</span> <span class="p">(</span><span class="nb">cons</span> <span class="ss">'b</span> <span class="p">(</span><span class="nb">cons</span> <span class="ss">'c</span> <span class="o">'</span><span class="p">())))</span>
<span class="c1">;Value 20: (a b c)</span>
</pre></td></tr></tbody></table></code></pre></figure>

<hr />

<p>Realising again that working with with lists in scheme is not very comfortable. I think most of these issue perhaps are because of my first in-depth experience with a non-typed langauge.</p>

<p>I generally found that there are fewer mistakes in the logical part of my approach compared to the implementation where most of the mistakes happen because I mixed wrong types.</p>

<p>Apart from this, this exercise is quite educational. It made me realise the nuances when we have to decide where to implement a feature? In the evaluator or on top of the implemented language.</p>

<p>I think, the main trouble here was because we want our evaluator to <em>know</em> the lazy <code class="highlighter-rouge">cons</code>. So, that it can print them. If this was not the requirement, we could have implemented it completely as procedures and it is the user concern how to print the customized cons.</p>

<p>But since we want that our evluator must know about the ‘cons’ because of this exercise, I think it would have been better if we implemented <code class="highlighter-rouge">cons</code> as special form instead of procedures. This would have made things easier as there was no mixing of the things from implemented language and the host language.</p>

<p>I am not sure if this is always possible to avoid this mixing. But, when this is the case, I think things can go quite complex and probably much more complex than this exercise.</p>

                        <hr/>
                    </span>

                    <br/>

                    

	<div id="disqus_thread"></div>
	<script>
		/**
		 * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
		 * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
		 */
		var disqus_identifier = 'inchmeal';

		
		var disqus_config = function () {
		 //this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
		 this.page.identifier = "/sicp/ch-4/ex-4.34.html"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
		};
		


		(function() { // DON'T EDIT BELOW THIS LINE
			var d = document, s = d.createElement('script');

			s.src = '//' + disqus_identifier + '.disqus.com/embed.js';

			s.setAttribute('data-timestamp', +new Date());
			(d.head || d.body).appendChild(s);
		})();
	</script>
	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>






                </article>
            </div><!-- /.small-11.columns -->
        </div><!-- /.row -->
    </div><!-- /.medium-8.columns -->
</div><!-- /.row -->


	    <div id="up-to-top" class="row">
      <div class="small-12 columns" style="text-align: right;">
        <a class="iconfont" title="Go to Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast')">&#xf108;</a>
      </div><!-- /.small-12.columns -->
    </div><!-- /.row -->

    <footer id="footer-content" class="bg-grau">
      <div id="subfooter">
        <nav class="row">
          <section id="subfooter-left" class="small-6 columns">
                <div class="column pl0 pr0">
                    <ul class="inline-list">
                        <li>Created with &hearts; by ovais</li>
                    </ul>
                </div>
                <div class="column pl0 pr0">
                    <ul class="inline-list">
                        
                        <li><a href="/rss-feed.xml"  target="_blank"  class="rss-link" title="Subscribe to RSS">RSS</a></li>
                        
                        <li><a href="mailto:mailovais85@gmail.com"  class="contact-link" title="Contact">Contact</a></li>
                        
                    </ul>
                </div>
              <div class="column pl0 pr0">
                  <ul class="inline-list">
                      <li>&copy;2019 inchmeal</li>
                  </ul>
              </div>
          </section>
          <section id="subfooter-right" class="small-6 columns social-icons end">
              <div class="column pl0 pr0">
              <ul class="inline-list">
                
                  <li><a href="http://twitter.com/0vai5" target="_blank" class="icon-twitter" title="Follow on twitter"></a></li>
                
                  <li><a href="http://github.com/0vais" target="_blank" class="icon-github" title="Follow on github"></a></li>
                
              </ul>
              </div>
          </section>
        </nav>
      </div><!-- /#subfooter -->
    </footer>


	<script src="https://www.inchmeal.io/assets/js/inchmeal_all.js"></script>

<script>
  var sectionName = "sicp";
  
  //google analytics
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-73233179-1', 'auto');
  ga('send', 'pageview');
  
</script>

</body>
</html>
